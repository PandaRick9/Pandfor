<!DOCTYPE html>
<html lang="ru" xmlns:th="https://thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Подбор сотрудников</title>
    <link rel="stylesheet" th:href="@{/css/jobPageStyle.css}"/>
</head>
<body>

<header th:insert="~{header :: header}"></header>
<main class="main-content">

    <section class="search-section">
        <form class="search-bar" th:method="POST" th:action="@{/search/vacancy}">
            <input type="text" name="query" placeholder="Поиск вакансии..." id="search-input">
            <button type="submit" id="search-btn">Найти</button>
        </form>
    </section>

    <section class="filters">
        <h2>Фильтры</h2>
        <form th:method="GET" th:action="@{/filters/vacancy}" id="filters-form">
        <div class="filters-container">

            <div class="filter-column">
                <div class="filter-box">
                    <h4>Формат работы</h4>
                    <div class="filter-options">
                        <label>
                            <input type="checkbox" name="workFormats" value="EMPLOYER_PLACE">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.WorkFormat).EMPLOYER_PLACE.label}">В офисе</span>
                        </label>
                        <label>
                            <input type="checkbox" name="workFormats" value="REMOTELY">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.WorkFormat).REMOTELY.label}">Удалённо</span>
                        </label>
                        <label>
                            <input type="checkbox" name="workFormats" value="HYBRID">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.WorkFormat).HYBRID.label}">Гибридный формат</span>
                        </label>
                    </div>
                </div>
                <div class="filter-box">
                    <h4>График работы</h4>
                    <div class="filter-options">
                        <label>
                            <input type="checkbox" name="schedules" value="FIVE_TWO">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.Schedule).FIVE_TWO.label}">5/2</span>
                        </label>
                        <label>
                            <input type="checkbox" name="schedules" value="TWO_TWO">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.Schedule).TWO_TWO.label}">2/2</span>
                        </label>
                        <label>
                            <input type="checkbox" name="schedules" value="THREE_THREE">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.Schedule).THREE_THREE.label}">3/3</span>
                        </label>
                        <label>
                            <input type="checkbox" name="schedules" value="ON_WEEKENDS">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.Schedule).ON_WEEKENDS.label}">По выходным</span>
                        </label>
                    </div>
                </div>
            </div>


            <div class="filter-column">
                <div class="filter-box">
                    <h4>Требуемый опыт</h4>
                    <div class="filter-options">
                        <label>
                            <input type="radio" name="experience" value="IT_DOESNT_METTER">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.ExperienceYear).IT_DOESNT_METTER.label}">Не имеет значения</span>
                        </label>
                        <label>
                            <input type="radio" name="experience" value="NO_EXPERIENCE">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.ExperienceYear).NO_EXPERIENCE.label}">Нет опыта</span>
                        </label>
                        <label>
                            <input type="radio" name="experience" value="ONE_THEE_YEAR">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.ExperienceYear).ONE_THEE_YEAR.label}">От 1 года до 3 лет</span>
                        </label>
                        <label>
                            <input type="radio" name="experience" value="THREE_SIX_YEAR">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.ExperienceYear).THREE_SIX_YEAR.label}">От 3 до 6 лет</span>
                        </label>
                        <label>
                            <input type="radio" name="experience" value="MORE_THE_SIX_YEAR">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.ExperienceYear).MORE_THE_SIX_YEAR.label}">Более 6 лет</span>
                        </label>
                    </div>
                </div>
                <div class="filter-box">
                    <h4>Тип занятости</h4>
                    <div class="filter-options">
                        <label>
                            <input type="checkbox" name="employmentTypes" value="FULL_TIME">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.EmploymentType).FULL_TIME.label}">Полная занятость</span>
                        </label>
                        <label>
                            <input type="checkbox" name="employmentTypes" value="PART_TIME">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.EmploymentType).PART_TIME.label}">Частичная занятость</span>
                        </label>
                        <label>
                            <input type="checkbox" name="employmentTypes" value="INTERNSHIP">
                            <span th:text="${T(by.baraznov.recruiting.models.enums.EmploymentType).INTERNSHIP.label}">Стажировка</span>
                        </label>
                    </div>
                </div>
            </div>


            <div class="filter-column-search">
                <div class="filter-box">
                    <h4>Название компании</h4>
                    <div class="text-inputs">
                        <input type="text" name="companyName" placeholder="Название компании"
                               th:value="${param.companyName}">
                    </div>
                </div>
                <div class="filter-box">
                    <h4>Город</h4>
                    <div class="text-inputs">
                        <input type="text" name="city" placeholder="Город"
                               th:value="${param.city}">
                    </div>
                </div>

            </div>


            <div class="filter-column">
                <div class="filter-box">
                    <h4>Уровень дохода</h4>
                    <div class="salary-inputs">
                        <input type="number" name="minSalary" placeholder="Минимум"
                               th:value="${param.minSalary}">
                        <input type="number" name="maxSalary" placeholder="Максимум"
                               th:value="${param.maxSalary}">
                    </div>
                </div>
                <div class="filter-box">
                    <button type="submit" class="filter-submit">Применить фильтры</button>
                </div>
            </div>
        </div>
        </form>
    </section>


    <section class="featured">
        <h2>Лучшие вакансии сайта</h2>
        <div th:each="vacancy : ${vacancies}" class="vacancy-card">
            <div class="vacancy-header">
                <h4 class="vacancy-title" th:text="${vacancy.title}">Название вакансии</h4>
                <div class="vacancy-salary-details">
                    <span class="salary" th:text="${vacancy.salary} + ' Br'">3000–3500 Br за месяц</span>
                    <span class="detail-badge" th:text="${vacancy.jobCondition.requiredExperienceYears}">Опыт 1–3 года</span>
                    <span class="detail-badge" th:text="${vacancy.jobCondition.employmentType}">Полная занятость</span>
                </div>
            </div>
            <div class="vacancy-company" th:if="${vacancy.company != null}">
                <span class="company-name" th:text="${vacancy.company.name}">Компания</span>
            </div>
            <div class="vacancy-location" th:if="${vacancy.company != null}">
                <span class="city" th:text="${vacancy.company.city}">Город</span>
            </div>

            <div class="vacancy-skills">
                <span>Требуемые навыки:</span>
                <span th:each="vs, stat : ${vacancy.vacancySkills}" th:if="${stat.index < 3}">
                        <span th:text="${vs.skill.name}">JavaScript</span>
                        <span th:if="${stat.index + 1 < #lists.size(vacancy.vacancySkills)
                       and stat.index < 2}">, </span>
                    </span>
                <span th:if="${#lists.size(vacancy.vacancySkills) > 3}">…</span>
            </div>
        </div>

    </section>
</main>

<script>
    document.getElementById('search-form').addEventListener('submit', function (e) {
        const filtersForm = document.getElementById('filters-form');
        const searchForm = document.getElementById('search-form');

        const inputs = filtersForm.querySelectorAll('input');

        inputs.forEach(input => {
            if ((input.type === 'checkbox' || input.type === 'radio') && !input.checked) return;

            const hiddenInput = document.createElement('input');
            hiddenInput.type = 'hidden';
            hiddenInput.name = input.name;
            hiddenInput.value = input.value;

            searchForm.appendChild(hiddenInput);
        });
    });
</script>

<footer th:insert="~{footer :: footer}"></footer>


<script src="/js/jobPageScript.js"></script>

</body>
</html>