<!DOCTYPE html>
<html lang="ru" xmlns:th="https://thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Все вакансии</title>
    <link rel="stylesheet" th:href="@{/css/vacancyPageStyle.css}"/>
</head>
<body>
<meta name="_csrf" th:content="${_csrf.token}"/>
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
<header class="header">
    <div class="left-section">
        <div><a class="logo" th:href="@{/job}">Pandfor</a></div>
    </div>
    <div class="right-section">
        <button class="resume-btn">Создать вакансию</button>
        <button class="login-btn">Войти</button>
    </div>
</header>

<div class="main-content">

    <div class="search-section">
        <div class="search-bar">
            <input type="text" placeholder="Поиск резюме..." id="search-input">
            <button id="search-btn">Найти</button>
        </div>
    </div>

    <h2 class="found-vacancies">Найдено: 354 вакансии</h2>

    <div class="content">
        <section class="filters">
            <h2>Фильтры</h2>
            <div class="filters-container">

                <div class="filter-column">
                    <div class="filter-box">
                        <h4>Формат работы</h4>
                        <div class="filter-options">
                            <label><input type="checkbox" name="format"> На месте работодателя</label>
                            <label><input type="checkbox" name="format"> Удалённо</label>
                            <label><input type="checkbox" name="format"> Гибрид</label>
                        </div>
                    </div>
                    <div class="filter-box">
                        <h4>График работы</h4>
                        <div class="filter-options">
                            <label><input type="checkbox" name="schedule"> 5/2</label>
                            <label><input type="checkbox" name="schedule"> 2/2</label>
                            <label><input type="checkbox" name="schedule"> 3/3</label>
                            <label><input type="checkbox" name="schedule"> По выходным</label>
                        </div>
                    </div>
                    <div class="filter-box">
                        <h4>Требуемый опыт</h4>
                        <div class="filter-options">
                            <label><input type="radio" name="experience"> Не имеет значения</label>
                            <label><input type="radio" name="experience"> Нет опыта</label>
                            <label><input type="radio" name="experience"> От 1 года до 3 лет</label>
                            <label><input type="radio" name="experience"> От 3 до 6 лет</label>
                            <label><input type="radio" name="experience"> Более 6 лет</label>
                        </div>
                    </div>
                    <div class="filter-box">
                        <h4>Тип занятости</h4>
                        <div class="filter-options">
                            <label><input type="checkbox" name="employment"> Полная занятость</label>
                            <label><input type="checkbox" name="employment"> Частичная занятость</label>
                            <label><input type="checkbox" name="employment"> Стажировка</label>
                        </div>
                    </div>
                    <div class="filter-box">
                        <h4>Название компании</h4>
                        <div class="salary-inputs">
                            <input type="text" placeholder="Название компании">
                        </div>
                    </div>
                    <div class="filter-box">
                        <h4>Город</h4>
                        <div class="salary-inputs">
                            <input type="text" placeholder="Город">
                        </div>
                    </div>
                    <div class="filter-box">
                        <h4>Уровень дохода</h4>
                        <div class="salary-inputs">
                            <input type="number" placeholder="Минимум">
                            <input type="number" placeholder="Максимум">
                        </div>
                    </div>
                    <div class="filter-box">
                        <button type="submit" class="filter-submit">Применить фильтры</button>
                    </div>
                </div>

            </div>
        </section>


        <div class="vacancy-list">

            <div th:each="vacancy : ${vacancies}" class="vacancy-card">
                <div class="vacancy-header">
                    <h4 class="vacancy-title" th:text="${vacancy.title}">Название вакансии</h4>
                    <div class="vacancy-salary-details">
                        <span class="salary" th:text="${vacancy.salary} + ' Br'">3000–3500 Br за месяц</span>
                        <span class="detail-badge" th:text="${vacancy.jobCondition.requiredExperienceYears}">Опыт 1–3 года</span>
                        <span class="detail-badge" th:text="${vacancy.jobCondition.employmentType}">Полная занятость</span>
                    </div>
                </div>

                <div class="vacancy-company" th:if="${vacancy.company != null}">
                    <span class="company-name" th:text="${vacancy.company.name}">Компания</span>
                </div>
                <div class="vacancy-location" th:if="${vacancy.company != null}">
                    <span class="city" th:text="${vacancy.company.city}">Город</span>
                </div>

                <!-- Навыки (максимум 3) -->
                <div class="vacancy-skills">
                    <span>Требуемые навыки:</span>
                    <span th:each="vs, stat : ${vacancy.vacancySkills}" th:if="${stat.index < 3}">
                        <span th:text="${vs.skill.name}">JavaScript</span>
                        <span th:if="${stat.index + 1 < #lists.size(vacancy.vacancySkills)
                       and stat.index < 2}">, </span>
                    </span>
                    <span th:if="${#lists.size(vacancy.vacancySkills) > 3}">…</span>
                </div>

                <button class="apply-btn"
                        th:attr="data-id=${vacancy.vacancyId}"
                        onclick="openModal(this)">
                    Откликнуться
                </button>
            </div>

        </div>

        <div id="applyModal" class="modal-overlay" style="display:none;">
            <div class="modal">
                <button class="modal-close" onclick="closeModal()">✕</button>
                <h2>Отклик на вакансию</h2>
                <p id="modalJobTitle" class="modal-job-title">Название вакансии</p>


                <form id="applyForm" enctype="multipart/form-data" th:action="@{/reaction/submit}" method="post" onsubmit="submitApplication(); return false;">
                    <div class="form-group">
                        <label for="coverLetter">Сопроводительное письмо</label>
                        <textarea id="coverLetter" name="coverLetter" class="form-textarea" placeholder="Ваше сопроводительное письмо…" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="resumeFile">Файл с резюме (PDF или DOCX)</label>
                        <input type="file" id="resumeFile" name="resumeFile" class="form-input" accept=".pdf,.doc,.docx">
                    </div>

                    <div class="form-group">
                        <label for="selectedResume">Выберите резюме из сохранённых</label>
                        <select id="selectedResume" name="selectedResumeId" class="form-select">
                            <th:block th:each="resume : ${resumes}">
                                <option th:value="${resume.resumeId}" th:text="${resume.title}">Резюме</option>
                            </th:block>
                        </select>
                    </div>

                    <input type="hidden" id="vacancyId" name="vacancyId" th:value="${vacancyId}">
                    <button type="submit" class="apply-btn1">Отправить отклик</button>
                </form>


            </div>
        </div>








        <script src="/js/vacancyPage.js"></script>

    </div>
</div>
<footer class="footer">
    <div class="footer-left">
        <h3>О компании</h3>
        <p>Мы помогаем компаниям находить лучших IT-специалистов.</p>
    </div>
    <div class="footer-center">
        <ul>
            <li><a href="#">О нас</a></li>
            <li><a href="#">Контакты</a></li>
            <li><a href="#">Политика конфиденциальности</a></li>
        </ul>
    </div>
    <div class="footer-right">
        <div class="socials">
            <a href="#">Facebook</a>
            <a href="#">Twitter</a>
            <a href="#">LinkedIn</a>
            <a href="#">Instagram</a>
        </div>
    </div>
</footer>

</body>
</html>
